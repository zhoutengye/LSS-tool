AI黑带专家智能分析系统
========================

概述
-----

AI黑带专家是本系统的核心创新功能，模拟精益六西格玛黑带专家的思维模式，自动串联多个LSS分析工具，进行综合诊断并生成可执行的改进方案。

**设计理念**

传统LSS工具箱需要用户手动选择工具、逐个运行分析、人工综合结论。AI黑带专家系统实现了：

1. **自动工具链编排** - 根据分析目标自动选择并串联多个工具
2. **智能综合诊断** - 模拟黑带专家思维，综合多个工具的分析结果
3. **可执行改进方案** - 自动生成符合DMAIC标准的改进路径
4. **专家级报告** - 生成包含根因分析、风险评估、改进建议的完整报告

**核心价值**

- **降低使用门槛** - 操作工人无需精通统计知识，一键获得专家级分析
- **提高分析效率** - 自动完成多工具分析，节省90%以上的分析时间
- **保证分析质量** - 基于标准化分析流程，避免人工分析的疏漏和偏差
- **知识传承** - 将黑带专家的经验固化到系统中，实现知识复用

功能特性
--------

**1. 自动工具链编排**

系统根据分析目标自动选择合适的工具组合，并按最优顺序执行：

.. code-block:: javascript

   // 自动分析流程示例
   步骤1: 帕累托图分析 → 识别关键问题（80/20法则）
   步骤2: SPC控制图   → 评估过程能力（Cpk分析）
   步骤3: 直方图分析   → 检验数据分布（正态性检验）
   步骤4: 箱线图对比   → 车间对比分析（识别最佳实践）
   步骤5: 综合诊断     → 生成改进方案（DMAIC路径）

**2. 智能综合诊断**

系统综合多个工具的分析结果，进行智能诊断：

- **过程能力等级判定** - 根据Cpk值自动判定A/B/C/D四个等级
- **根因分析** - 综合SPC违规点、正态性检验、异常值检测结果，识别根本原因
- **风险评估** - 根据过程能力、稳定性、数据分布等多维度评估风险等级
- **优先级排序** - 自动判定问题优先级（紧急/高/中/低）

**3. DMAIC改进路径生成**

系统自动生成符合DMAIC（定义、测量、分析、改进、控制）标准的改进路径：

- **Define阶段** - 聚焦关键问题，设定改进目标
- **Measure阶段** - 建立测量系统分析，确保数据可靠性
- **Analyze阶段** - 验证根本原因，使用鱼骨图、5Why等工具
- **Improve阶段** - 优化工艺参数，实施统计过程控制
- **Control阶段** - 建立控制计划，培训操作人员，持续改进

**4. 可视化报告**

系统生成包含以下内容的专家级报告：

- **过程健康度雷达图** - 多维度评估过程健康状态
- **能力等级统计卡片** - Cpk指数、过程状态、能力等级
- **根因分析时间线** - 按影响程度排序的根因列表
- **DMAIC改进路线图** - 分阶段、可执行的改进措施
- **预期收益评估** - 量化改进后的预期收益

技术实现
--------

**前端实现**

AI黑带专家页面位于 ``frontend/src/pages/IntelligentAnalysisPage.jsx``

关键代码结构：

.. code-block:: javascript

   const runBlackBeltAnalysis = async () => {
     // 步骤1: 帕累托图识别关键问题
     const paretoRes = await axios.get('/api/lss/pareto/demo');
     const paretoAnalysis = await axios.post('/api/lss/pareto/analyze', {
       categories: paretoRes.data.data,
       threshold: 0.8
     });

     // 步骤2: SPC控制图评估过程能力
     const spcRes = await axios.post('/api/lss/spc/analyze', {
       param_code: 'P_E01_TEMP',
       node_code: 'E01',
       limit: 50
     });

     // 步骤3: 直方图检验正态性
     const histogramRes = await axios.post('/api/lss/histogram/analyze', {
       param_code: 'P_E01_TEMP',
       node_code: 'E01',
       limit: 100,
       bins: 10
     });

     // 步骤4: 箱线图对比分析
     const boxplotRes = await axios.get('/api/lss/boxplot/demo');
     const boxplotAnalysis = await axios.post('/api/lss/boxplot/analyze', {
       param_codes: boxplotRes.data.config.param_codes,
       limit_per_series: 50
     });

     // 步骤5: 综合诊断
     const diagnosis = generateBlackBeltDiagnosis({
       keyProblems,
       cpk,
       processStatus,
       isNormal,
       skewness,
       comparison,
       spcViolations,
       outliers
     });

     setAnalysisResult(diagnosis);
   };

**后端实现**

后端提供4个LSS工具的API端点：

- ``GET /api/lss/pareto/demo`` - 获取帕累托图演示数据
- ``POST /api/lss/pareto/analyze`` - 执行帕累托图分析
- ``POST /api/lss/spc/analyze`` - 执行SPC控制图分析
- ``POST /api/lss/histogram/analyze`` - 执行直方图分析
- ``GET /api/lss/boxplot/demo`` - 获取箱线图演示数据
- ``POST /api/lss/boxplot/analyze`` - 执行箱线图分析

详细的后端实现请参考 :doc:`backend` 文档。

**诊断逻辑**

系统的诊断逻辑基于以下规则：

1. **能力等级判定**

   - Cpk ≥ 1.33: 优秀 (A级)
   - 1.0 ≤ Cpk < 1.33: 良好 (B级)
   - 0.67 ≤ Cpk < 1.0: 勉强 (C级)
   - Cpk < 0.67: 不足 (D级)

2. **根因分析**

   - 非正态分布: 偏度 > 1 或 Shapiro-Wilk检验 p < 0.05
   - 过程不稳定: SPC控制图检测到违规点
   - 过程能力不足: Cpk < 1.0
   - 异常值过多: 箱线图检测到多个异常值

3. **综合结论**

   - 低优先级: Cpk ≥ 1.33 且无违规点且符合正态分布
   - 中优先级: Cpk ≥ 1.0 且高影响根因 ≤ 1个
   - 高优先级: Cpk ≥ 0.67 或高影响根因 ≤ 2个
   - 紧急优先级: Cpk < 0.67 或过程严重失控

使用示例
--------

**操作步骤**

1. 点击顶部导航栏的"AI黑带专家"按钮
2. 点击"启动黑带分析流程"按钮
3. 系统自动执行5个分析步骤，显示进度条
4. 分析完成后，自动生成综合诊断报告

**报告内容**

报告包含以下部分：

1. **核心结论卡片**
   - 过程能力等级（A/B/C/D级）
   - Cpk指数（保留3位小数）
   - 过程状态（受控/失控）

2. **过程健康度雷达图**
   - 过程能力
   - 稳定性
   - 正态性
   - 控制水平
   - 改进空间

3. **黑带专家综合结论**
   - 根据分析结果自动生成的文字结论
   - 包含问题描述、影响评估、改进建议

4. **根因分析时间线**
   - 按影响程度排序的根因列表
   - 每个根因包含证据和影响等级

5. **DMAIC改进路径**
   - Define、Measure、Analyze、Improve、Control五个阶段
   - 每个阶段包含具体的改进措施
   - 前2个阶段高亮显示（优先执行）

6. **关键问题识别**
   - 帕累托图分析识别的关键问题
   - 显示频次和累计占比

7. **预期收益**
   - 缺陷率预计降低百分比
   - 过程稳定性提升百分比
   - 向标杆车间学习建议

**适用场景**

- **日常监控** - 定期（如每周）运行一次，评估过程健康状态
- **问题诊断** - 当过程出现异常时，快速定位根本原因
- **改进项目** - 启动六西格玛改进项目前，进行现状评估
- **管理汇报** - 向管理层展示过程能力和改进计划

**案例示例**

假设某车间的提取温度数据如下：

- Cpk = 0.85（勉强C级）
- 检测到5个SPC违规点
- 数据不符合正态分布（偏度 = 1.5）
- 箱线图检测到8个异常值

系统自动生成以下诊断报告：

**综合结论**:
"过程能力不足或存在明显异常，需要立即启动改进项目。"

**根因分析**:
1. 数据分布偏态 - 偏度=1.50，说明过程存在系统性偏差 [高影响]
2. 过程不稳定 - 检测到5个控制图违规点 [高影响]
3. 异常值过多 - 箱线图检测到8个异常值 [中影响]

**DMAIC改进路径**:
- Define: 聚焦关键问题: 温度异常、压力异常 | 设定改进目标: Cpk从0.85提升至1.35
- Measure: 建立测量系统分析(MSA)，确保数据可靠性
- Analyze: 验证根因: 数据分布偏态 - 偏度=1.50，说明过程存在系统性偏差
- Improve: 优化工艺参数，减少变异（DOE实验设计）| 实施统计过程控制(SPC)，设置预警机制
- Control: 建立控制计划(Control Plan)，明确监控频率 | 培训操作人员，确保新方法得到有效执行

**预期收益**:
- 缺陷率预计降低 48%
- 过程稳定性提升 50%
- 向标杆车间最佳实践学习，减少变异

与人工分析对比
----------------

**传统人工分析流程**

1. 手动选择SPC工具 → 运行分析 → 记录结果
2. 手动选择帕累托图工具 → 运行分析 → 记录结果
3. 手动选择直方图工具 → 运行分析 → 记录结果
4. 手动选择箱线图工具 → 运行分析 → 记录结果
5. 人工综合4个工具的结果
6. 人工编写诊断报告
7. 人工制定改进方案

**耗时**: 约2-4小时（需要专业知识）

**AI黑带专家系统**

1. 点击"启动黑带分析流程"按钮
2. 系统自动执行4个工具分析
3. 系统自动综合诊断并生成报告
4. 系统自动生成DMAIC改进路径

**耗时**: 约30秒（无需专业知识）

**优势总结**

- **效率提升**: 从2-4小时缩短到30秒，提升240-480倍
- **降低门槛**: 无需掌握统计知识，操作工人即可使用
- **保证质量**: 标准化分析流程，避免人工疏漏
- **知识传承**: 将黑带专家经验固化到系统中
- **持续改进**: 系统可持续学习和优化诊断逻辑

未来规划
--------

**短期规划**（1-3个月）

1. **扩展工具链** - 集成更多LSS工具（如相关性分析、回归分析）
2. **优化诊断逻辑** - 基于实际案例持续优化诊断规则
3. **个性化报告** - 支持用户自定义报告模板

**中期规划**（3-6个月）

1. **AI增强** - 引入机器学习算法，自动识别复杂模式
2. **预测性分析** - 基于历史数据预测未来趋势
3. **多语言支持** - 支持英文等多语言界面

**长期规划**（6-12个月）

1. **自动改进** - 系统自动实施部分改进措施（如参数调整）
2. **闭环优化** - 形成分析-改进-验证的闭环优化流程
3. **知识图谱集成** - 深度集成故障树、FMEA等知识图谱数据

相关文档
--------

- :doc:`index` - 系统概览
- :doc:`toolbox` - LSS工具箱详细说明
- :doc:`frontend` - 前端组件文档
- :doc:`backend` - 后端API文档
